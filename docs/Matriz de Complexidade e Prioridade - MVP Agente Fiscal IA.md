# **Matriz de Complexidade e Prioridade \- MVP Agente Fiscal IA**

**√öltima Atualiza√ß√£o:** 28 de Outubro de 2025

## üìä Resumo do Status

| M√©trica | Valor | Observa√ß√£o |
|---------|-------|------------|
| **Progresso Geral** | **25%** | 8 de 32 tarefas conclu√≠das |
| **Backend Core** | **54%** | 7/13 tarefas conclu√≠das |
| **Backend Relat√≥rios** | **0%** | 0/3 tarefas (n√£o iniciado) |
| **Frontend** | **0%** | 0/7 tarefas (n√£o iniciado) |
| **Refatora√ß√£o** | **0%** | 0/6 tarefas (n√£o iniciado) |

### üéØ Conquistas Recentes
- ‚úÖ **NFeTaxSpecialistAgent implementado** (754 linhas + 316 exemplos)
- ‚úÖ **Upload CSV NF-e funcional** (321K registros processados)
- ‚úÖ **Schema banco completo** (3 tabelas + views + functions)
- ‚úÖ **Valida√ß√µes fiscais** (CFOP, NCM, valores, consist√™ncia)

### ‚è≥ Bloqueadores Cr√≠ticos
1. üî¥ **M√≥dulo de fraude n√£o removido** - C√≥digo legado presente
2. üî¥ **Endpoints de relat√≥rios ausentes** - Funcionalidade essencial MVP
3. üî¥ **Frontend n√£o iniciado** - Interface zero

---

Esta matriz visa auxiliar na prioriza√ß√£o e planejamento do desenvolvimento do MVP (Minimum Viable Product) do Agente Fiscal IA, classificando os principais √âpicos e Tarefas T√©cnicas do backlog quanto √† sua complexidade estimada e import√¢ncia para a primeira entrega funcional.

**Legenda de Status:**
* ‚úÖ **CONCLU√çDO:** Implementado e testado
* üü° **PARCIAL:** Parcialmente implementado ou com pend√™ncias
* ‚è≥ **PENDENTE:** N√£o iniciado

**Legenda:**

* **Complexidade:**  
  * **Baixa:** Tarefa relativamente simples, com requisitos bem definidos e poucas depend√™ncias. Envolve tecnologia conhecida.  
  * **M√©dia:** Tarefa com alguma complexidade t√©cnica ou de requisitos, pode envolver integra√ß√µes ou l√≥gica de neg√≥cio moderada.  
  * **Alta:** Tarefa complexa, envolvendo l√≥gica de neg√≥cio intrincada, novas tecnologias, integra√ß√µes desafiadoras ou requisitos ainda n√£o totalmente definidos. Alto risco ou incerteza.  
* **Prioridade MVP:**  
  * **Essencial:** Funcionalidade *core* sem a qual o MVP n√£o entrega o valor m√≠nimo proposto.  
  * **Importante:** Funcionalidade que agrega valor significativo ao MVP, mas poderia ser adiada em caso extremo.  
  * **Desej√°vel:** Funcionalidade interessante, mas n√£o cr√≠tica para a valida√ß√£o inicial do produto.

**Observa√ß√£o:** Esta √© uma estimativa inicial e deve ser revisada e ajustada pela equipe de desenvolvimento.

| Item do Backlog | Complexidade | Prioridade MVP | Status | Notas / Justificativa |
| :---- | :---- | :---- | :---- | :---- |
| **Backend (agentnfe-backend)** |  |  |  |  |
| **√âpico: Isolar/Remover M√≥dulo de Fraude** | **M√©dia** | **Essencial** | ‚è≥ **PENDENTE** | Refatora√ß√£o pode ter efeitos colaterais. Requer cuidado para n√£o quebrar o que fica. Limpeza do DB exige aten√ß√£o. |
| ‚Ü≥ Tarefa: Mapear c√≥digo/dados | Baixa | Essencial | ‚è≥ PENDENTE |  |
| ‚Ü≥ Tarefa: Remover c√≥digo/arquivos (Backend/Frontend) | M√©dia | Essencial | ‚è≥ PENDENTE | Requer busca cuidadosa e remo√ß√£o em m√∫ltiplos locais. |
| ‚Ü≥ Tarefa: Remover Endpoints API | Baixa | Essencial | ‚è≥ PENDENTE |  |
| ‚Ü≥ Tarefa: Limpar DB Vetorial | Baixa | Essencial | ‚è≥ PENDENTE | Script SQL simples, mas requer confirma√ß√£o. |
| ‚Ü≥ Tarefa: Testar funcionalidade b√°sica p√≥s-remo√ß√£o | Baixa | Essencial | ‚è≥ PENDENTE |  |
| **√âpico: Parsing de Documentos Fiscais (XML NF-e)** | **Alta** | **Essencial** | üü° **PARCIAL** | ‚úÖ CSV implementado (321K registros). ‚è≥ XML NF-e pendente. |
| ‚Ü≥ Tarefa: Desenvolver parser XML NF-e (campos MVP) | Alta | Essencial | üü° PARCIAL | ‚úÖ CSV completo. ‚è≥ XML com namespaces pendente. |
| ‚Ü≥ Tarefa: Adaptar ingest√£o (data\_ingestor.py) | M√©dia | Essencial | ‚úÖ **CONCLU√çDO** | ‚úÖ `NFeUploader` implementado com detec√ß√£o autom√°tica. |
| ‚Ü≥ Tarefa: Modelar/Implementar armazenamento (Supabase) | M√©dia | Essencial | ‚úÖ **CONCLU√çDO** | ‚úÖ Migration 0008: 3 tabelas + views + functions + √≠ndices. |
| **√âpico: Valida√ß√µes Fiscais Essenciais (MVP)** | **M√©dia** | **Importante** | üü° **PARCIAL** | ‚úÖ Valida√ß√µes implementadas. ‚è≥ Integra√ß√£o no upload e API pendentes. |
| ‚Ü≥ Tarefa: Definir/Implementar 2-3 regras | M√©dia | Importante | ‚úÖ **CONCLU√çDO** | ‚úÖ CFOP, NCM, valores, consist√™ncia UF implementados. |
| ‚Ü≥ Tarefa: Integrar valida√ß√µes na ingest√£o | Baixa | Importante | ‚è≥ PENDENTE | Valida√ß√µes existem mas n√£o integradas no upload. |
| ‚Ü≥ Tarefa: Criar API para inconsist√™ncias | Baixa | Importante | ‚è≥ PENDENTE | Endpoint `/nfe/{id}/inconsistencias` n√£o criado. |
| **√âpico: Base de Conhecimento Fiscal (Legisla√ß√£o MVP)** | **M√©dia** | **Importante** | üü° **PARCIAL** | ‚úÖ Infraestrutura RAG pronta. ‚è≥ Conte√∫do legisla√ß√£o pendente. |
| ‚Ü≥ Tarefa: Definir/Adquirir conte√∫do inicial | Baixa | Importante | ‚è≥ PENDENTE | LC 123/2006, RICMS n√£o carregados. |
| ‚Ü≥ Tarefa: Estruturar/Carregar base inicial (RAG) | M√©dia | Importante | üü° PARCIAL | ‚úÖ Sistema RAG funcional. ‚è≥ Legisla√ß√£o espec√≠fica ausente. |
| ‚Ü≥ Tarefa: Documentar processo manual atualiza√ß√£o | Baixa | Importante | ‚è≥ PENDENTE |  |
| ‚Ü≥ Tarefa: Ajustar prompts rag\_agent | M√©dia | Importante | üü° PARCIAL | ‚úÖ Prompts fiscais em NFeTaxSpecialistAgent. |
| **√âpico: Gera√ß√£o de Relat√≥rio Fiscal B√°sico (MVP)** | **M√©dia** | **Essencial** | ‚è≥ **PENDENTE** | Dados estruturados prontos, mas endpoint n√£o implementado. |
| ‚Ü≥ Tarefa: Definir formato/par√¢metros relat√≥rio | Baixa | Essencial | ‚è≥ PENDENTE | Especifica√ß√£o de layout n√£o criada. |
| ‚Ü≥ Tarefa: Criar servi√ßo backend relat√≥rio | M√©dia | Essencial | ‚è≥ PENDENTE | L√≥gica SQL/ORM para filtro por per√≠odo ausente. |
| ‚Ü≥ Tarefa: Criar endpoint API relat√≥rio | Baixa | Essencial | ‚è≥ PENDENTE | Rota `/relatorios/listagem_nfe` n√£o existe. |
| Tarefa: Refatorar agentes (integra√ß√£o m√≠nima) | M√©dia | Essencial | üü° PARCIAL | ‚úÖ NFeTaxSpecialistAgent criado. ‚è≥ Orquestrador n√£o integrado. |
| Tarefa: Revisar prompts principais (contexto fiscal) | Baixa | Importante | ‚úÖ **CONCLU√çDO** | ‚úÖ Prompts fiscais implementados em specialist agent. |
| Tarefa: Criar testes unit√°rios essenciais (MVP) | M√©dia | Importante | ‚è≥ PENDENTE | Testes para parsing/relat√≥rio n√£o criados. |
| **Frontend (agentnfe-frontend)** |  |  |  |  |
| **√âpico: Se√ß√£o B√°sica de Relat√≥rios (MVP)** | **M√©dia** | **Essencial** | ‚è≥ **PENDENTE** | Backend pronto, frontend n√£o iniciado. |
| ‚Ü≥ Tarefa: Desenhar interface simples relat√≥rio | Baixa | Essencial | ‚è≥ PENDENTE |  |
| ‚Ü≥ Tarefa: Criar rota/p√°gina React Relat√≥rios | Baixa | Essencial | ‚è≥ PENDENTE |  |
| ‚Ü≥ Tarefa: Implementar Tabela (shadcn/ui/table) | M√©dia | Essencial | ‚è≥ PENDENTE | Configurar colunas, dados, talvez pagina√ß√£o. |
| ‚Ü≥ Tarefa: Integrar com API relat√≥rio | M√©dia | Essencial | ‚è≥ PENDENTE | L√≥gica de fetch, tratamento de estado (loading/erro), filtros de data. |
| **√âpico: UX Funcional para MVP** | **Baixa** | **Essencial** | ‚è≥ **PENDENTE** | Ajustes pontuais na UI existente para suportar o fluxo MVP. |
| ‚Ü≥ Tarefa: Ajustar upload para XML | Baixa | Essencial | ‚è≥ PENDENTE | Permitir extens√£o .xml e dar feedback. |
| ‚Ü≥ Tarefa: Adicionar filtro per√≠odo (Frontend) | Baixa | Essencial | ‚è≥ PENDENTE | Usar componentes de calend√°rio/data. |
| Tarefa: Garantir responsividade b√°sica | Baixa | Importante | ‚è≥ PENDENTE | Verificar novas telas em diferentes resolu√ß√µes. |

**An√°lise Preliminar para MVP:**

* **Essenciais (Alta Prioridade):** O isolamento da fraude, o parsing de NF-e, o armazenamento estruturado, o relat√≥rio b√°sico (backend e frontend) e a integra√ß√£o m√≠nima dos agentes s√£o cruciais. Sem eles, o sistema n√£o funciona ou n√£o entrega o valor fiscal m√≠nimo.  
* **Importantes:** As valida√ß√µes fiscais e a base de conhecimento RAG, embora muito valiosas, podem talvez ter uma implementa√ß√£o *muito* simplificada no primeir√≠ssimo MVP, focando em demonstrar o *mecanismo* em vez da *abrang√™ncia*. Os testes tamb√©m s√£o importantes, mas podem come√ßar focados no caminho feliz.  
* **Complexidade Alta:** O parsing do XML NF-e √© provavelmente o maior desafio t√©cnico individual.

**Recomenda√ß√£o:**

1. Iniciar pelo **Isolamento da Fraude** para limpar a base de c√≥digo.  
2. Focar no fluxo **Parsing NF-e \-\> Armazenamento \-\> Relat√≥rio B√°sico (Backend \+ Frontend)**.  
3. Implementar a **Base de Conhecimento M√≠nima** e ajustar o **RAG/Orquestrador**.  
4. Adicionar as **Valida√ß√µes Fiscais Essenciais**.  
5. Refor√ßar com **Testes Unit√°rios**.

Esta matriz deve ser o ponto de partida para a discuss√£o da equipe, que poder√° refinar as estimativas de complexidade e ajustar as prioridades com base no conhecimento t√©cnico e na vis√£o de neg√≥cio.